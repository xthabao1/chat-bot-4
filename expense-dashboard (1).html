<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Chi Ti√™u C√° Nh√¢n</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .summary-card h3 {
            font-size: 0.9em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .summary-card .amount {
            font-size: 2em;
            font-weight: bold;
        }

        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .input-section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 5px;
            color: #333;
            font-weight: 600;
            font-size: 0.95em;
        }

        input[type="number"] {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-container {
            display: flex;
            gap: 10px;
            justify-content: center;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-add {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-add:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-reset {
            background: #e74c3c;
            color: white;
        }

        .btn-reset:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .chart-container h3 {
            color: #667eea;
            margin-bottom: 15px;
            text-align: center;
        }

        .history-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
        }

        .history-section h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .history-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            background: white;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .history-item:hover {
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        }

        .history-info {
            flex: 1;
        }

        .history-category {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 5px;
        }

        .history-amount {
            font-size: 1.2em;
            color: #e74c3c;
            font-weight: bold;
        }

        .history-date {
            font-size: 0.85em;
            color: #999;
        }

        .btn-delete {
            background: #e74c3c;
            color: white;
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .btn-delete:hover {
            background: #c0392b;
        }

        .category-colors {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
            justify-content: center;
        }

        .category-tag {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .cat-food { background: #FF6B6B; color: white; }
        .cat-transport { background: #4ECDC4; color: white; }
        .cat-study { background: #45B7D1; color: white; }
        .cat-entertainment { background: #FFA07A; color: white; }
        .cat-other { background: #95E1D3; color: white; }

        @media (max-width: 768px) {
            .charts-section {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .empty-state i {
            font-size: 3em;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üí∞ Dashboard Chi Ti√™u</h1>
        <p class="subtitle">Qu·∫£n l√Ω chi ti√™u th√¥ng minh cho h·ªçc sinh - sinh vi√™n</p>

        <!-- T·ªïng quan -->
        <div class="summary">
            <div class="summary-card">
                <h3>T·ªïng Chi Ti√™u</h3>
                <div class="amount" id="totalExpense">0 ƒë</div>
            </div>
            <div class="summary-card">
                <h3>S·ªë Giao D·ªãch</h3>
                <div class="amount" id="totalTransactions">0</div>
            </div>
            <div class="summary-card">
                <h3>Chi Nhi·ªÅu Nh·∫•t</h3>
                <div class="amount" id="topCategory">---</div>
            </div>
        </div>

        <!-- Form nh·∫≠p li·ªáu -->
        <div class="input-section">
            <h2>üìù Th√™m Kho·∫£n Chi</h2>
            <form id="expenseForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="food">üçú ƒÇn u·ªëng</label>
                        <input type="number" id="food" min="0" placeholder="Nh·∫≠p s·ªë ti·ªÅn (VNƒê)">
                    </div>
                    <div class="form-group">
                        <label for="transport">üöå ƒêi l·∫°i</label>
                        <input type="number" id="transport" min="0" placeholder="Nh·∫≠p s·ªë ti·ªÅn (VNƒê)">
                    </div>
                    <div class="form-group">
                        <label for="study">üìö H·ªçc t·∫≠p</label>
                        <input type="number" id="study" min="0" placeholder="Nh·∫≠p s·ªë ti·ªÅn (VNƒê)">
                    </div>
                    <div class="form-group">
                        <label for="entertainment">üéÆ Gi·∫£i tr√≠</label>
                        <input type="number" id="entertainment" min="0" placeholder="Nh·∫≠p s·ªë ti·ªÅn (VNƒê)">
                    </div>
                    <div class="form-group">
                        <label for="other">‚ùì Kh√°c</label>
                        <input type="number" id="other" min="0" placeholder="Nh·∫≠p s·ªë ti·ªÅn (VNƒê)">
                    </div>
                </div>
                <div class="btn-container">
                    <button type="submit" class="btn-add">‚ûï Th√™m Kho·∫£n Chi</button>
                    <button type="button" class="btn-reset" onclick="resetAllData()">üóëÔ∏è X√≥a T·∫•t C·∫£</button>
                </div>
            </form>
        </div>

        <!-- Bi·ªÉu ƒë·ªì -->
        <div class="charts-section">
            <div class="chart-container">
                <h3>üìä Bi·ªÉu ƒê·ªì Tr√≤n - T·ª∑ L·ªá Chi Ti√™u</h3>
                <canvas id="pieChart"></canvas>
            </div>
            <div class="chart-container">
                <h3>üìà Bi·ªÉu ƒê·ªì C·ªôt - So S√°nh C√°c Kho·∫£n</h3>
                <canvas id="barChart"></canvas>
            </div>
        </div>

        <!-- L·ªãch s·ª≠ giao d·ªãch -->
        <div class="history-section">
            <h2>üìú L·ªãch S·ª≠ Giao D·ªãch</h2>
            <div class="history-list" id="historyList">
                <div class="empty-state">
                    <div style="font-size: 3em;">üì≠</div>
                    <p>Ch∆∞a c√≥ giao d·ªãch n√†o. H√£y th√™m kho·∫£n chi ƒë·∫ßu ti√™n!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // D·ªØ li·ªáu m·∫∑c ƒë·ªãnh
        const categories = {
            food: { name: 'ƒÇn u·ªëng', icon: 'üçú', color: '#FF6B6B' },
            transport: { name: 'ƒêi l·∫°i', icon: 'üöå', color: '#4ECDC4' },
            study: { name: 'H·ªçc t·∫≠p', icon: 'üìö', color: '#45B7D1' },
            entertainment: { name: 'Gi·∫£i tr√≠', icon: 'üéÆ', color: '#FFA07A' },
            other: { name: 'Kh√°c', icon: '‚ùì', color: '#95E1D3' }
        };

        // L·∫•y d·ªØ li·ªáu t·ª´ localStorage
        function getData() {
            const data = localStorage.getItem('expenseData');
            return data ? JSON.parse(data) : [];
        }

        // L∆∞u d·ªØ li·ªáu v√†o localStorage
        function saveData(data) {
            localStorage.setItem('expenseData', JSON.stringify(data));
        }

        // Format ti·ªÅn
        function formatMoney(amount) {
            return new Intl.NumberFormat('vi-VN', { 
                style: 'currency', 
                currency: 'VND' 
            }).format(amount);
        }

        // T√≠nh t·ªïng theo danh m·ª•c
        function getTotalByCategory() {
            const data = getData();
            const totals = {};
            
            Object.keys(categories).forEach(cat => {
                totals[cat] = 0;
            });

            data.forEach(item => {
                if (totals[item.category] !== undefined) {
                    totals[item.category] += item.amount;
                }
            });

            return totals;
        }

        // C·∫≠p nh·∫≠t t·ªïng quan
        function updateSummary() {
            const data = getData();
            const totals = getTotalByCategory();
            
            const totalExpense = Object.values(totals).reduce((a, b) => a + b, 0);
            const totalTransactions = data.length;
            
            let topCategory = '---';
            let maxAmount = 0;
            
            Object.entries(totals).forEach(([cat, amount]) => {
                if (amount > maxAmount) {
                    maxAmount = amount;
                    topCategory = categories[cat].icon + ' ' + categories[cat].name;
                }
            });

            document.getElementById('totalExpense').textContent = formatMoney(totalExpense);
            document.getElementById('totalTransactions').textContent = totalTransactions;
            document.getElementById('topCategory').textContent = topCategory;
        }

        // V·∫Ω bi·ªÉu ƒë·ªì
        let pieChart, barChart;

        function updateCharts() {
            const totals = getTotalByCategory();
            const labels = Object.keys(categories).map(key => categories[key].name);
            const values = Object.keys(categories).map(key => totals[key]);
            const colors = Object.keys(categories).map(key => categories[key].color);

            // Bi·ªÉu ƒë·ªì tr√≤n
            const pieCtx = document.getElementById('pieChart').getContext('2d');
            if (pieChart) pieChart.destroy();
            
            pieChart = new Chart(pieCtx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: values,
                        backgroundColor: colors,
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = formatMoney(context.parsed);
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((context.parsed / total) * 100).toFixed(1);
                                    return `${label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });

            // Bi·ªÉu ƒë·ªì c·ªôt
            const barCtx = document.getElementById('barChart').getContext('2d');
            if (barChart) barChart.destroy();
            
            barChart = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Chi ti√™u (VNƒê)',
                        data: values,
                        backgroundColor: colors,
                        borderWidth: 0,
                        borderRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return formatMoney(context.parsed.y);
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return (value / 1000) + 'k';
                                }
                            }
                        }
                    }
                }
            });
        }

        // C·∫≠p nh·∫≠t l·ªãch s·ª≠
        function updateHistory() {
            const data = getData();
            const historyList = document.getElementById('historyList');
            
            if (data.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-state">
                        <div style="font-size: 3em;">üì≠</div>
                        <p>Ch∆∞a c√≥ giao d·ªãch n√†o. H√£y th√™m kho·∫£n chi ƒë·∫ßu ti√™n!</p>
                    </div>
                `;
                return;
            }

            historyList.innerHTML = data.map((item, index) => {
                const cat = categories[item.category];
                return `
                    <div class="history-item">
                        <div class="history-info">
                            <div class="history-category">${cat.icon} ${cat.name}</div>
                            <div class="history-amount">${formatMoney(item.amount)}</div>
                            <div class="history-date">${new Date(item.date).toLocaleString('vi-VN')}</div>
                        </div>
                        <button class="btn-delete" onclick="deleteTransaction(${index})">üóëÔ∏è X√≥a</button>
                    </div>
                `;
            }).reverse().join('');
        }

        // X√≥a giao d·ªãch
        function deleteTransaction(index) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a kho·∫£n chi n√†y?')) {
                const data = getData();
                data.splice(index, 1);
                saveData(data);
                updateAll();
            }
        }

        // X√≥a t·∫•t c·∫£
        function resetAllData() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a T·∫§T C·∫¢ d·ªØ li·ªáu?')) {
                localStorage.removeItem('expenseData');
                updateAll();
            }
        }

        // C·∫≠p nh·∫≠t to√†n b·ªô
        function updateAll() {
            updateSummary();
            updateCharts();
            updateHistory();
        }

        // X·ª≠ l√Ω form
        document.getElementById('expenseForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const data = getData();
            let hasData = false;

            Object.keys(categories).forEach(cat => {
                const input = document.getElementById(cat);
                const amount = parseFloat(input.value);
                
                if (amount && amount > 0) {
                    data.push({
                        category: cat,
                        amount: amount,
                        date: new Date().toISOString()
                    });
                    hasData = true;
                    input.value = '';
                }
            });

            if (hasData) {
                saveData(data);
                updateAll();
                alert('‚úÖ ƒê√£ th√™m kho·∫£n chi th√†nh c√¥ng!');
            } else {
                alert('‚ö†Ô∏è Vui l√≤ng nh·∫≠p √≠t nh·∫•t m·ªôt kho·∫£n chi!');
            }
        });

        // Kh·ªüi t·∫°o
        updateAll();
    </script>
</body>
</html>
